#!/bin/bash
set -euo pipefail

APP_BUNDLE="/Applications/oneShotTranscoder.app"
BIN_LINK="/usr/local/bin/transcode"
PKG_ID="com.transcoder.pkg"

# Remove symlink if present
if [ -L "$BIN_LINK" ] || [ -f "$BIN_LINK" ]; then
  rm -f "$BIN_LINK" || true
  echo "Removed symlink: $BIN_LINK"
fi

# Remove app bundle (if not already deleted by user)
if [ -d "$APP_BUNDLE" ]; then
  rm -rf "$APP_BUNDLE" || true
  echo "Removed app bundle: $APP_BUNDLE"
fi

# Best-effort: forget package receipt if it exists
if command -v pkgutil >/dev/null 2>&1; then
  pkgutil --forget "$PKG_ID" >/dev/null 2>&1 || true
fi

echo "One Shot Transcoder uninstalled."
exit 0
